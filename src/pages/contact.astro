---
import Layout from '../layouts/Layout.astro';

const zones = [
  "Lille",
  "Roubaix",
  "Tourcoing",
  "Villeneuve-d'Ascq",
  "Wattrelos",
  "Marcq-en-Bar≈ìul",
  "La Madeleine",
  "Lambersart",
  "Loos",
  "Armenti√®res",
  "Croix",
  "Wasquehal",
  "Hem",
  "Faches-Thumesnil",
  "Mons-en-Bar≈ìul",
  "Wattignies",
  "Seclin",
  "Halluin",
  "Ronchin",
  "Saint-Andr√©-lez-Lille",
  "Bondues",
  "Lesquin",
  "Mouvaux",
  "Wambrechies",
  "Leers",
  "Lys-lez-Lannoy",
  "Roncq",
  "Neuville-en-Ferrain",
  "Haubourdin",
  "Comines"
];
---

<Layout
  title="Contact | Nuisibles-Lille"
  description="Contactez notre √©quipe d'experts en d√©sinfestation √† Lille. Devis gratuit et intervention rapide pour tous vos probl√®mes de nuisibles."
>
  <section class="bg-primary text-white py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <h1 class="text-4xl font-bold mb-6">Contactez-nous</h1>
        <p class="text-xl max-w-3xl mx-auto">
          Une urgence ? Une question ? Contactez-nous pour une intervention rapide
          et un devis gratuit.
        </p>
      </div>
    </div>
  </section>

  <section class="py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
        <!-- Contact Form -->
        <div>
          <h2 class="text-2xl font-semibold mb-6">Demande de diagnostic / devis gratuit</h2>
          <form
          action="https://formspree.io/f/xzzbvpdz"
          method="POST"
          class="space-y-6"
          id="contact-form"
        >
          <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div>
              <label for="firstname" class="block text-sm font-medium text-gray-700">Pr√©nom</label>
              <input
                type="text"
                name="firstname"
                id="firstname"
                required
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
              />
            </div>
            <div>
              <label for="lastname" class="block text-sm font-medium text-gray-700">Nom</label>
              <input
                type="text"
                name="lastname"
                id="lastname"
                required
                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
              />
            </div>
          </div>
        
          <div>
            <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
            <input
              type="email"
              name="email"
              id="email"
              required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
            />
          </div>
        
          <div>
            <label for="location" class="block text-sm font-medium text-gray-700">Ville</label>
            <select
              id="location"
              name="location"
              required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
            >
              <option value="">S√©lectionnez votre ville</option>
              {zones.map(zone => (
                <option value={zone}>{zone}</option>
              ))}
              <option value="autre">Autre ville</option>
            </select>
          </div>
        
          <div>
            <label for="type" class="block text-sm font-medium text-gray-700">Type de nuisible</label>
            <select
              id="type"
              name="type"
              required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
            >
              <option value="">S√©lectionnez le type de nuisible</option>
              <option value="rats">Rats et souris</option>
              <option value="cafards">Cafards</option>
              <option value="punaises">Punaises de lit</option>
              <option value="frelons">Frelons et gu√™pes</option>
              <option value="autre">Autre</option>
            </select>
          </div>
        
          <div>
            <label for="message" class="block text-sm font-medium text-gray-700">Message</label>
            <textarea
              id="message"
              name="message"
              rows="4"
              required
              class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary focus:ring-primary"
            ></textarea>
          </div>
        
          <div>
            <button
              type="submit"
              class="w-full bg-accent text-white py-3 px-6 rounded-lg hover:bg-opacity-90 transition-colors font-semibold"
            >
              Envoyer la demande
            </button>
          </div>
        </form>
        
        </div>

        <!-- Contact Information -->
        <div>
          <h2 class="text-2xl font-semibold mb-6">Informations de contact</h2>
          
          <div class="space-y-6">
            <div class="bg-gray-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold mb-4">Coordonn√©es</h3>
              <ul class="space-y-3">
                <li class="flex items-start">
                  <span class="text-primary mr-3">üìß</span>
                  <div>
                    <p class="font-medium">Email</p>
                    <a href="mailto:contact@nuisibles-lille.fr" class="text-accent hover:underline">
                      contact@nuisibles-lille.fr
                    </a>
                  </div>
                </li>
                <li class="flex items-start">
                  <span class="text-primary mr-3">üìç</span>
                  <div>
                    <p class="font-medium">Zone d'intervention</p>
                    <p class="text-gray-600">Lille et sa m√©tropole</p>
                  </div>
                </li>
              </ul>
            </div>

            <div class="bg-gray-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold mb-4">Horaires</h3>
              <ul class="space-y-2 text-gray-600">
                <li class="flex justify-between">
                  <span>Lundi - Vendredi</span>
                  <span>8h - 19h</span>
                </li>
                <li class="flex justify-between">
                  <span>Samedi</span>
                  <span>9h - 18h</span>
                </li>
                <li class="mt-4 text-accent font-medium">
                  Intervention d'urgence 24h/24 et 7j/7
                </li>
              </ul>
            </div>

            <div class="bg-gray-50 p-6 rounded-lg">
              <h3 class="text-lg font-semibold mb-4">Zone d'intervention</h3>
              <div class="grid grid-cols-2 gap-2 text-gray-600">
                {zones.map(zone => (
                  <div class="flex items-center">
                    <span class="text-accent mr-2">‚úì</span>
                    <span>{zone}</span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</Layout>

<script type="module">
  document.getElementById('contact-form')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const form = e.target;

    try {
      const formData = new FormData(form);
      const response = await fetch(form.action, {
        method: 'POST',
        body: formData,
        headers: {
          Accept: 'application/json',
        },
      });

      if (response.ok) {
        showToast('Votre message a √©t√© envoy√© avec succ√®s !');
        form.reset();
      } else {
        showToast('Une erreur est survenue. Veuillez r√©essayer.', 'error');
      }
    } catch (error) {
      console.error(error);
      showToast('Une erreur est survenue. Veuillez r√©essayer.', 'error');
    }
  });

  function showToast(message, type = "success") {
    const toastContainer = document.getElementById("toast-container");
    const toast = document.createElement("div");
    toast.className = `toast ${type === "error" ? "toast-error" : ""}`;
    toast.textContent = message;

    toastContainer.appendChild(toast);

    setTimeout(() => {
      toastContainer.removeChild(toast);
    }, 3000);
  }
</script>

